<div class="cadastro-container">
  <h2>Novo Lançamento</h2>

  <div *ngIf="mensagemSucesso" class="success-message">{{ mensagemSucesso }}</div>
  <div *ngIf="mensagemErro" class="error-message">{{ mensagemErro }}</div>

  <form [formGroup]="lancamentoForm" (ngSubmit)="salvar()">

    <div class="form-grid">

      <div class="form-group">
        <label for="descricao">Descrição *</label>
        <input id="descricao" type="text" formControlName="descricao">
        <div *ngIf="lancamentoForm.get('descricao')?.invalid && lancamentoForm.get('descricao')?.touched" class="validation-error">
          Descrição é obrigatória (máx. 100 caracteres).
        </div>
      </div>

      <div class="form-group">
        <label for="parcela">Parcela *</label>
        <input id="parcela" type="text" formControlName="parcela">
      </div>

      <div class="form-group">
        <label for="valorDocumento">Valor *</label>
        <input id="valorDocumento" type="number" formControlName="valorDocumento" step="0.01">
      </div>

      <div class="form-group">
        <label for="dataVencimento">Data Vencimento *</label>
        <input id="dataVencimento" type="date" formControlName="dataVencimento">
      </div>

      <div class="form-group">
        <label for="pessoaId">Pessoa (Credor/Devedor) *</label>
        <select id="pessoaId" formControlName="pessoaId">
          <option [ngValue]="null" disabled>Selecione a Pessoa</option>
          <option *ngFor="let p of pessoas" [ngValue]="p.id">
            {{ p.nome }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="centroCustoId">Centro de Custo *</label>
        <select id="centroCustoId" formControlName="centroCustoId">
          <option [ngValue]="null" disabled>Selecione o Centro de Custo</option>
          <option *ngFor="let cc of centrosCusto" [ngValue]="cc.id">
            {{ cc.nome }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="contaId">Conta Financeira *</label>
        <select id="contaId" formControlName="contaId">
          <option [ngValue]="null" disabled>Selecione a Conta</option>
          <option *ngFor="let c of contas" [ngValue]="c.id">
            {{ c.nome }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="tipoLancamento">Tipo *</label>
        <select id="tipoLancamento" formControlName="tipoLancamento">
          <option value="DEBITO">DEBITO (Despesa)</option>
          <option value="CREDITO">CREDITO (Receita)</option>
        </select>
      </div>

      <div class="form-group">
        <label for="situacao">Situação *</label>
        <select id="situacao" formControlName="situacao">
          <option value="ABERTO">ABERTO</option>
          <option value="BAIXADO">BAIXADO</option>
        </select>
      </div>

      <div class="form-group hidden-field">
        <label for="dataLancamento">Data Lançamento (Registro)</label>
        <input id="dataLancamento" type="date" formControlName="dataLancamento">
      </div>

    </div>

    <div class="form-actions">
      <button type="button" class="btn btn-secondary" [routerLink]="['/lancamentos']">Cancelar</button>
      <button type="submit" class="btn btn-primary" [disabled]="lancamentoForm.invalid || carregando">
        <span *ngIf="carregando">Salvando...</span>
        <span *ngIf="!carregando">Salvar Lançamento</span>
      </button>
    </div>
  </form>
</div>
